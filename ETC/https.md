# HTTPS(HyperText Transfer Protocol Secure Socket Layer)

- 서로 다른 두 컴퓨터가 네트워크 통해 안전하게 메시지 주고받기 위해 만든 프로토콜

- TCP 대신 전송 계층 보안(Transport Layer Security) 프로토콜을 기반으로 하는 HTTP

  - TLS는 OSI 7계층 중 네번째에 해당하는 전송 계층의 TCP 프로토콜을 기반으로 동작하는 보안 프로토콜

  - TLS 등장 전에는 보안 소켓 계층(Secure Sockets Layer) 프로토콜 사용했으나 많은 취약점으로 사용되지 않음

- HTTPS 사용하면 서버와 클라이언트가 주고받는 메시지를 암호화하여 제삼자가 볼 수 없음

  - 메시지 암호화/복호화할 때 사용하는 키는 HTTPS로 메시지 주고받는 두 컴퓨터만 알기 때문에 제삼자가 메시지 보더라도 암호화되어 내용 알 수 없음

- HTTPS 연결 과정에서 서버가 보낸 인증서가 신뢰할 수 있는 기관에서 인증했는지 인증 기간이 만료되지 않았는지 검증

- HTTPS는 TLS 기반으로 TLS 버전에 따라 사용 가능한 암호화 목록과 안정성이 달라짐

  - TLS 1.0 : 1990년대 말 제정된 최초의 TLS 버전으로 SSL 3.0과 일부 호환됨. 오래 전에 제정돼서 모든 암호 알고리즘에 취약점 있음.

  - TLS 1.1 : 1.0 프로토콜에서 발견된 취약점들을 개선하고 더 강력한 암호 알고리즘 사용.

  - TLS 1.2 : 1.1 프로토콜에서 서명, 랜덤 함수 등에서 사용하는 MD5/SHA-1 해시 함수들을 사용할 수 없게 제거하고 알고리즘을 SHA-2 기반으로 바꾸고, 사용 가능한 암호 목록도 더 강력하고 안전함.

- HTTPS 프로토콜은 핸드셰이킹 과정에서 RSA 알고리즘과 DHE(Diffie-Hellman ephemeral) 알고리즘 중 한 가지 방법 사용하여 제삼자가 연결 과정을 보더라도 키 유추할 수 없게 해서 키를 안전하게 교환하도록 함.

  - RSA 알고리즘을 사용한 키 교환 방식은 취약하여 TLS 1.3부터는 지원하지 않음. 모든 클라이언트와의 키 교환이 서버 공개키 하나에 의존하기 때문에 비공개키가 한 번이라도 노출되면 과거에 주고받았던 메시지나 미래에 주고받을 모든 메시지까지 복호화 가능.

  - DHE 알고리즘은 공개키를 주고받은 이후 추가 과정을 더해 키를 만들기 때문에 비밀키가 노출되더라도 과거에 주고받았던 메시지가 노출될 일은 없음.(Perfect Forward Security) 비밀키가 노출됐기 때무에 미래에 주고받을 메시지는 여전히 노출될 수 있음. DHE 알고리즘 취약점을 보완하기 위해 ECDHE(Elliptic Curve Diffie-Hellman ephemeral) 알고리즘을 HTTPS 키 교환 시 사용.

- HTTPS 통신을 하기 위해 필요한 인증서의 표준인 X.509는 신뢰할 수 있는 인증 기관(CA)에서만 발급 가능하면 일정 비용 지불하면 누구나 발급 가능

  - X.509 인증서는 발행 기관, 인증서 버전, 고유 번호, 인증서 소유자 및 소유자 정보 등을 포함

  - 인증서는 도메인 1개를 지원하는 싱글 도메인, 제한된 개수의 서브 도메인을 지원하는 멀티 도메인, 개수 제한이 없는 서브 도메인을 지원하는 와일드 카드(\*) 도메인 인증서 있음

  - 인증서 도메인 이름(CN)은 최대 64글자까지 사용 가능

  - 모든 인증서에는 인증서 변조를 막기 위한 서명이 있음. 서명은 비밀키 알고 있는 기관에서만 만들 수 있음.

  - 클라이언트는 인증서를 중간 기관에서 발급했더라도 이 기관이 최상위 기관으로부터 인증서 발급받았다는 서명을 찾아 신뢰할 수 있는 기관인지 확인 가능한 것을 연쇄 신뢰 혹은 신뢰 체인이라고 함
