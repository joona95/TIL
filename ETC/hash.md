# 해시 함수

## 해시 함수란

- 임의의 입력값을 고정된 길이의 해시 값으로 변환하는 함수

- 해싱에서 사용하는 함수가 해시 함수

    - 변환하기 전 입력값은 문자, 숫자, 바이너리 등의 모든 형태로 사용하고, 변환 후 해시 값은 바이너리 형태로 반환되는 과정을 해싱이라고 함

- 입력값이 동일하면 해시 함수로 계산한 해시 값도 동일함

- 입력값의 길이와 상관없이 해시 값의 길이는 항상 동일함

- 서로 다른 입력값이 동일한 해시 값을 만들어 해시 충돌이 일어날 확률은 낮음

- 해시 값으로 입력값을 복원하는 방법은 불가능해야 함

- 서로 다른 입력값으로 같거나 비슷한 해시 값을 찾는 방법은 불가능해야 함

- 취약점은 언제든 발견될 수 있으므로 암호학적으로 안전한 해시 함수는 현시점에서 안전하다는 뜻

- 해시 함수가 데이터 암호화를 제공하지는 않으므로 인터넷을 통해 데이터 주고 받을 때 해시 값과 별개로 데이터 자체를 암호화할 필요가 있음

- 해시 값을 키로 사용할 때는 충돌 처리가 필수적

- 입력값의 크기, 보안 수중, 해시 값의 용도를 고민한 후 사용할 해시 함수 결정


## 해시 함수 활용

- 비밀번호와 같은 민감한 데이터 보관

    - 비밀번호 검증
        
        - 해시 함수 이용하면 입력값이 이전에 저장한 값과 같은지 비교 가능

        - 입력값에 솔트(salt)라는 문자열을 더한 후 해싱은 실무에서 비밀번호 저장 시 반드시 사용해야 하는 기술

            - 솔트가 없다면 입력값이 같으면 결과값도 같은 해시 함수 특징 이용해 원래 비밀번호 유추 가능

            - 솔트가 없다면 노출된 해시 값을 같은 해시 함수를 쓰는 다른 서비스에서 비밀번호 사용 가능

- 바이너리 데이터의 무결성 검증

    - 중복 데이터를 검사하는 데 아용하거나 파일의 무결성 검사 시 사용

    - 블록체인 거래 정보의 무결성 검증

        - 해시 함수 이용하면 데이터가 변하지 않았다는 것을 보장할 수 있음
    
    - MurmurHash3처럼 암호학적으로 민감하지 않되 성능이 매우 빠른 해시 함수 사용하는 것이 좋음

    - 충돌 확률은 낮을수록 좋지만 충돌 처리가 필요하지 않거나, 충돌 시 다른 값을 비교하는 형태로 해결 가능

- 해시 값을 키로 사용

    - 데이터 크기가 크다면 성능을 중요시하되 충돌 가능성이 가장 낮은 해시 함수 사용

    - 길이가 충분히 길어 충돌 확률이 낮더라도 생성된 키가 많을수록 충돌 확률 기하급수적으로 높아지므로 충돌 가능성을 염두에 두고 충돌 해결 처리 방법 추가


## 해시 함수 종류

### **MD5(message-digest algorithm5)**

- 1990년대 이후부터 사용해온 해시 알고리즘

- 서로 다른 두 값으로 해시 충돌 만들 수 있다는 사실이 발견돼서 거의 사용되지 않음

### **SHA-1(Secure Hash Algorithm-1)**

- 미국 국가안보국(NSA)에서 설계한 표준 해시 함수

- 최대 2^64비트 데이터를 입력값으로 사용할 수 있고 고정된 160비트의 해시 값을 생성

- 2017년 구글과 네덜란드 국립 정보연구소(CWI)에서 서로 다른 입력값으로 해시 충돌 만들 수 있다는 사실이 발견돼서 사용하지 않는 추세

- MD5보다는 충돌 가능성이 낮아서 파일의 무결성 검사나 해시 맵의 키로 사용하는 등 암호학적으로 안전하지 않아도 괜찮은 곳에서 사용됨

### **SHA-2(Secure Hash Algorithm-2)**

- 함수 하나를 지칭하는 것이 아니라 SHA-224, SHA-256, SHA-384, SHA-512 등 여러 해시 함수 의미

- SHA-1보다 안전하기 때문에 SHA-1 취약점 발견 이후부터 가장 많이 사용되는 해시 함수


## 해시 함수 생성 속도

- 안전한 함수일수록 더 긴 길이를 사용함

- 해시 함수가 안전할수록 계산하는 데 드는 비용도 커짐

- 안전한 해시 함수 사용하면 민감한 데이터를 안전하게 저장 가능하지만 해시 값 계산 비용이 크므로 무차별 대입 공격(brute force attack)이나 서비스 거부 공격(DDOS) 같이 매우 많은 요청을 동시에 보낼 경우 서비스 장애 발생

    - 대규모 사용자를 기반으로 한 서비스 개발 시에는 SHA-2 해시 함수 사용 대신 멀티 코어 활용 가능한 Blake2b 해시 함수 사용
